# 消息通信

客户端与服务端之间的消息通信使用 WebSocket 协议。

与消息有关的数据结构在 `app/core/entity/message` 目录下。

## 消息类型

消息类型在 `app/core/entity/message/message.py` 文件中定义，不同的消息类型有不同的数据结构。

### init 消息

init 消息是用户发送的第一条消息，它用于初始化 agent 的上下文。会携带 对象存储服务 的配置信息。agent context 里面的 BaseStorageCredentials(对象存储配置) 就在这个阶段设置的

### chat 消息

chat 消息是用户发送的聊天消息，它用于和 agent 进行交互

## 消息结构

- app/core/entity/message/message.py 里面存放客户端和服务端共有的消息结构
- app/core/entity/message/server_message.py 里面存放服务端的消息结构
- app/core/entity/message/client_message.py 里面存放客户端的消息结构

## 消息处理入口

消息处理入口在 app/api/routes/websocket.py 文件中，它负责处理消息的接收、解析和处理。
